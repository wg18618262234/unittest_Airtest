# -*- coding:utf-8 -*-
# author:yangcong
# datetime:2020/2/10 4:27 下午
# software: PyCharm
import requests, json, datetime, time
from config import chromedrive_path
from selenium.webdriver.chrome.options import Options


def report_result():
    from selenium import webdriver
    chrome_options = Options()
    chrome_options.add_argument('--headless')
    driver = webdriver.Chrome(chromedrive_path, chrome_options=chrome_options)
    driver.get('http://localhost:8000/report.html')
    total = driver.find_element_by_xpath('//*[@id="total_row"]/td[2]').text
    success = driver.find_element_by_xpath('//*[@id="total_row"]/td[3]').text
    error = driver.find_element_by_xpath('//*[@id="total_row"]/td[4]').text
    exception = driver.find_element_by_xpath('//*[@id="total_row"]/td[5]').text
    result = {
        'total': total,
        'success': success,
        'error': error,
        'exception': exception,
    }
    return result


def send_dingTalk_msg():
    result = report_result()
    if int(result.get('error')) + int(result.get('exception')):
        webHook = 'https://oapi.dingtalk.com/robot/send?access_token=f2b04f372e55708392455511bff3ac2aff7ee49065a5a8b2cbd85e5295faf9cf'
        headers = {
            'Content-Type': 'application/json',
        }
        now_time = datetime.datetime.fromtimestamp(time.time() + 86400).strftime("%Y-%m-%d %H:%M:%S")
        data = json.dumps(
            {
                "msgtype": "markdown",
                "markdown": {
                    "title": "测试报告",
                    "text": "#### 测试报告\n" +
                            "> 总数 {} 通过 {} 失败 {} 错误 {} \n\n".format(result.get('total'), result.get('success'),
                                                                    result.get('error'), result.get('exception')) +
                            "> 点击 [查看unittest测试报告](http://192.168.28.145:8000/report.html)\n\n" +
                            "> 点击 [生成airtest测试报告](http://192.168.28.145:5000/export_web_report)\n\n" +
                            "> 点击 [查看airtest测试报告](http://192.168.28.145:8000)\n\n" +
                            # "> ![screenshot](data:image/png;base64,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)\n" +
                            "> ###### {} 发布 \n".format(now_time)
                },
                "at": {
                    "isAtAll": False
                }
            }
        )
        r = requests.post(url=webHook, headers=headers, data=data)
        return r
    else:
        return '无异常'


if __name__ == '__main__':
    # print(report_result())
    r = send_dingTalk_msg()
    print(r.text)
